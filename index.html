<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0">
<title>Bongo ChatGPT</title>
<style>
    * {
        box-sizing: border-box;
    }

    body {
        margin: 0;
        font-family: Arial, sans-serif;
        background-color: #fff;
        color: #000;
        display: flex;
        flex-direction: column;
        height: 100vh;
        overflow: hidden;
    }

    /* ===== Top Bar ===== */
    .top-bar {
        background-color: rgba(190, 190, 190, 0.85);
        padding: 10px 20px;
        display: flex;
        align-items: center;
        font-size: 1.2em;
        font-weight: bold;
        color: #000;
        border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        position: fixed;
        top: 0;
        width: 100%;
        z-index: 10;
        box-shadow: 0px 2px 2px rgba(0, 0, 0, 0.1);
    }

    .logo img {
        height: 40px;
        width: auto;
        margin-right: 10px;
    }

    /* ===== Chat Area ===== */
    .chat-container {
        flex: 1;
        display: flex;
        flex-direction: column;
        margin-top: 60px;
        margin-bottom: 70px;
        overflow: hidden;
        position: relative;
    }

    .chat-content {
        flex: 1;
        overflow-y: auto;
        padding: 15px;
        scroll-behavior: smooth;
    }

    .chat-content::-webkit-scrollbar {
        width: 6px;
    }

    .chat-content::-webkit-scrollbar-thumb {
        background-color: rgba(0, 0, 0, 0.2);
        border-radius: 10px;
    }

    .message {
        display: flex;
        align-items: flex-end;
        margin-bottom: 10px;
    }

    .message.user {
        justify-content: flex-end;
    }

    .message.bot {
        justify-content: flex-start;
    }

    .bubble {
        padding: 10px 14px;
        border-radius: 20px;
        max-width: 80%;
        line-height: 1.4;
        word-wrap: break-word;
    }

    .message.user .bubble {
        background-color: #007BFF;
        color: #fff;
        border-bottom-right-radius: 4px;
    }

    .message.bot .bubble {
        background-color: #f0f0f0;
        color: #000;
        border-bottom-left-radius: 4px;
    }

    .avatar {
        width: 36px;
        height: 36px;
        border-radius: 50%;
        margin: 0 8px;
    }

    /* Loading Animation */
    .loading {
        background-color: #f0f0f0;
        border-radius: 20px;
        padding: 10px 15px;
    }

    .dots {
        display: flex;
        gap: 5px;
    }

    .dot {
        width: 8px;
        height: 8px;
        background-color: #000;
        border-radius: 50%;
        animation: blink 1.4s infinite;
    }

    .dot:nth-child(2) { animation-delay: 0.2s; }
    .dot:nth-child(3) { animation-delay: 0.4s; }

    @keyframes blink {
        0%, 80%, 100% { opacity: 0; }
        40% { opacity: 1; }
    }

    /* ===== Bottom Bar ===== */
    .bottom-bar {
        display: flex;
        align-items: center;
        padding: 10px;
        background-color: rgba(110, 110, 110, 0.68);
        border-top: 1px solid rgba(0, 0, 0, 0.1);
        position: fixed;
        bottom: 0;
        width: 100%;
        z-index: 10;
    }

    .bottom-bar input {
        flex: 1;
        padding: 12px 15px;
        border: none;
        border-radius: 20px;
        font-size: 1em;
        background-color: #f9f9f9;
        color: #000;
        outline: none;
    }

    .bottom-bar button {
        padding: 10px 18px;
        margin-left: 10px;
        border: none;
        border-radius: 20px;
        background-color: #007BFF;
        color: #fff;
        cursor: pointer;
        transition: 0.3s;
    }

    .bottom-bar button:hover {
        background-color: #0056b3;
    }

    /* ===== VIDEO BACKGROUND ===== */
    .video-bg {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        object-fit: cover;
        z-index: -1;
        filter: brightness(0.4);
    }

    /* Fix for mobile keyboard */
    @media (max-width: 768px) {
        .chat-content {
            padding-bottom: 100px;
        }
    }
</style>
</head>
<body>

<!-- ===== VIDEO BACKGROUND ===== -->
<video autoplay loop muted playsinline class="video-bg">
    <source src="vd/develop%20(4).mp4" type="video/mp4">
</video>

<!-- ===== TOP BAR ===== -->
<div class="top-bar">
    <div class="logo">
        <img src="img/beats-electronics-logo.png" alt="logo">
    </div>
    <span>bongo <b>ChatGPT</b></span>
</div>

<!-- ===== CHAT CONTAINER ===== -->
<div class="chat-container">
    <div id="chat-content" class="chat-content"></div>
</div>

<!-- ===== INPUT BAR ===== -->
<form id="chat-form" class="bottom-bar">
    <input id="user-input" type="text" placeholder="Type your message..." autocomplete="off">
    <button type="submit">Send</button>
</form>

<script>
const chatContent = document.getElementById("chat-content");
const chatForm = document.getElementById("chat-form");
const userInput = document.getElementById("user-input");

const chatGPTLogo = "img/beats-electronics-logo.png";
const userLogo = "img/use.png";

function parseMarkdown(text) {
    text = text.replace(/```([\s\S]*?)```/g, '<pre><code>$1</code></pre>');
    text = text.replace(/`([^`]+)`/g, '<code>$1</code>');
    text = text.replace(/\*\*([^*]+)\*\*/g, '<strong>$1</strong>');
    text = text.replace(/\*([^*]+)\*/g, '<em>$1</em>');
    text = text.replace(/\n/g, '<br/>');
    return text;
}

function createMessageElement(message, fromUser, isLoading = false) {
    const messageWrapper = document.createElement("div");
    messageWrapper.classList.add("message", fromUser ? "user" : "bot");

    const avatar = document.createElement("img");
    avatar.src = fromUser ? userLogo : chatGPTLogo;
    avatar.classList.add("avatar");

    const bubble = document.createElement("div");
    if (isLoading) {
        bubble.classList.add("loading");
        bubble.innerHTML = `<div class="dots"><div class="dot"></div><div class="dot"></div><div class="dot"></div></div>`;
    } else {
        bubble.classList.add("bubble");
        bubble.innerHTML = parseMarkdown(message);
    }

    if (fromUser) {
        messageWrapper.appendChild(bubble);
        messageWrapper.appendChild(avatar);
    } else {
        messageWrapper.appendChild(avatar);
        messageWrapper.appendChild(bubble);
    }

    return messageWrapper;
}

async function fetchResponse(userMessage) {
    try {
        const response = await fetch("https://backend.buildpicoapps.com/aero/run/llm-api?pk=v1-Z0FBQUFBQm5IZkJDMlNyYUVUTjIyZVN3UWFNX3BFTU85SWpCM2NUMUk3T2dxejhLSzBhNWNMMXNzZlp3c09BSTR6YW1Sc1BmdGNTVk1GY0liT1RoWDZZX1lNZlZ0Z1dqd3c9PQ==", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ prompt: userMessage })
        });
        const data = await response.json();
        return data.status === "success" ? data.text : "There was an error. Please try again.";
    } catch {
        return "Error connecting. Please check your internet.";
    }
}

chatForm.addEventListener("submit", async (e) => {
    e.preventDefault();
    const userMessage = userInput.value.trim();
    if (!userMessage) return;

    chatContent.appendChild(createMessageElement(userMessage, true));
    userInput.value = "";

    const loadingMessage = createMessageElement("", false, true);
    chatContent.appendChild(loadingMessage);
    chatContent.scrollTop = chatContent.scrollHeight;

    const botResponse = await fetchResponse(userMessage);

    chatContent.removeChild(loadingMessage);
    chatContent.appendChild(createMessageElement(botResponse, false));
    chatContent.scrollTop = chatContent.scrollHeight;
});

// Welcome message
window.addEventListener("load", () => {
    const welcome = createMessageElement("How can I help you today?", false);
    chatContent.appendChild(welcome);
    chatContent.scrollTop = chatContent.scrollHeight;
});
</script>

</body>
</html>
